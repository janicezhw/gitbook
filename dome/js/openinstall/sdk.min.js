OpenInstall=function(e,t,n){function r(e){if(!e)return"";var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&void 0!==r&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return t.sort().join("&")}function o(e){var t=new n,r=e.data,o=e.url,i=e.method;r&&"string"!=typeof r&&(r=c.stringify(r)),"POST"!=i&&r&&(o=o+(o.indexOf("?")>-1?"&":"?")+r,r=null),t.onreadystatechange=function(){if(t.readyState==n.DONE,!0){if(200==t.status){var r=t.response||t.responseText||{};e.success&&e.success("string"==typeof r?c.parse(r):r)}else e.error&&e.error(t,t.statusText);e.complete&&e.complete(t)}},t.ontimeout=function(){e.error&&e.error(t,t.statusText)},t.timeout=e.timeout||0,t.open(i,o,!0),t.setRequestHeader&&t.setRequestHeader("Content-Type","application/json;charset=utf-8"),t.withCredentials=(e.xhrFields||{}).withCredentials,t.send(r)}var i=function(){"use strict";function n(){if(!i){i=!0;for(var t=0;t<o.length;t++)o[t].fn.call(e,o[t].ctx);o=[]}}function r(){"complete"===t.readyState&&n()}var o=[],i=!1,a=!1;return function(c,u){return i?void setTimeout(function(){c(u)},1):(o.push({fn:c,ctx:u}),void("complete"===t.readyState||!t.attachEvent&&"interactive"===t.readyState?setTimeout(n,1):a||(t.addEventListener?(t.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(t.attachEvent("onreadystatechange",r),e.attachEvent("onload",n)),a=!0)))}}(),a=function(){return function(e){return e(null)}}(),c=e.JSON||{parse:function(e){return eval("("+e+")")},stringify:function(){var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)},n={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},r=function(e){return n[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)},o=/[\\"\u0000-\u001F\u2028\u2029]/g;return function i(n){if(null==n)return"null";if("number"==typeof n)return isFinite(n)?n.toString():"null";if("boolean"==typeof n)return n.toString();if("object"==typeof n){if("function"==typeof n.toJSON)return i(n.toJSON());if(t(n)){for(var a="[",c=0;c<n.length;c++)a+=(c?", ":"")+i(n[c]);return a+"]"}if("[object Object]"===e.call(n)){var u=[];for(var l in n)n.hasOwnProperty(l)&&u.push(i(l)+": "+i(n[l]));return"{"+u.sort().join(", ")+"}"}}return'"'+n.toString().replace(o,r)+'"'}}()};return function(n,c){function u(n){function r(n){for(var r=0;r<i.length;r++)t.removeEventListener(i[r],n),e.removeEventListener(i[r],n)}function o(){for(var o=function(e){clearTimeout(n),r(o)},a=0;a<i.length;a++){var c=i[a];t.addEventListener(c,o),e.addEventListener(c,o)}}var i=["focus","focusout","visibilitychange","webkitvisibilitychange","mozvisibilitychange","beforeunload","pagehide","blur","unload","resize"];o()}function l(e,n){var r=(new Date).getTime();if("ios"==m.platform||"qq"==m.brower){var o=t.createElement("a");o.style.display="none",o.href=e,t.body.appendChild(o),o.click()}else{var i=t.createElement("iframe");i.style.width="1px",i.style.height="1px",i.border="none",i.style.display="none",i.src=e,t.body.appendChild(i)}if("function"==typeof n){var a=1500,c=setTimeout(function(){(new Date).getTime()-r-a<1e3&&n()},a);u(c)}}function s(e){var n=t.createElement("div");return n.innerHTML=e,n=n.children[0],n.onclick=function(){t.body.removeChild(n)},n}function f(n){n?n():m.fallbackUrl?e.location=m.fallbackUrl:g&&t.body.appendChild(g)}function d(){if(R.length){for(var e=0;e<R.length;e++)v(R[e]);R=[]}"function"==typeof n.onready&&n.onready(O)}function h(){m&&m.platform&&!j&&(j=!0,o({url:(n.server||"http://openlink.cc")+"/stats/click?"+r({appKey:x,platform:m.platform,channelCode:m.channelCode}),method:"GET",xhrFields:{withCredentials:!0}}))}function p(e){m.schemaUrl?l(m.schemaUrl,function(){f(e)}):f(e)}function v(e){m?(h(),i(function(){p(e)})):R[R.length]=e}function y(e,t){var i=(n.server||"http://openlink.cc")+"/bind/"+x+"?"+r(e);o({url:i,method:"POST",xhrFields:{withCredentials:!0},data:t,success:function(e){m=e||{},e.shadow&&(g=s(e.shadow)),d()}})}n=n||{};var m,g,b,w,C,E,O=this,S=n.channelCode,x=n.appKey;if(!x)return void alert("未指定appKey");if(!S&&""!==S){var T=/[\?\&]channelCode=([^=&]+)$/.exec(e.location.href);T&&T.length>1&&(S=T[1])}try{b=e.screen.width||"",w=e.screen.height||"",E=e.devicePixelRatio||"";var L=t.createElement("canvas").getContext("webgl");C=L.getParameter(L.VERSION)}catch(k){}var j,R=[];this.wakeupOrInstall=v,a(function(e){var t={channelCode:S,w:b,h:w,p:E,g:C,i:e};y(t,c)})}}(window,document,XMLHttpRequest);